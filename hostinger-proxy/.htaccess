# Configuração para SPA React + Webhooks + Bot API
# IMPORTANTE: Este arquivo deve estar na raiz do public_html

RewriteEngine On
RewriteBase /

# ============================================
# WEBHOOKS DE PAGAMENTO (devem vir ANTES das regras SPA)
# ============================================

# Webhook Asaas - POST em /webhook ou /asaas
RewriteCond %{REQUEST_METHOD} POST
RewriteRule ^webhook/?$ /api/webhook-asaas.php [L]

RewriteCond %{REQUEST_METHOD} POST
RewriteRule ^asaas/?$ /api/webhook-asaas.php [L]

# ============================================
# BOT API (permite GET e POST)
# ============================================

# API do Bot - /bot-api ou /api/bot-api
RewriteRule ^bot-api/?$ /api/bot-api.php [L]

# ============================================
# SPA FALLBACK (React Router)
# ============================================

# Se o arquivo ou diretório existir, serve diretamente
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Ignora arquivos de API e assets
RewriteCond %{REQUEST_URI} !^/api/
RewriteCond %{REQUEST_URI} !^/assets/
RewriteCond %{REQUEST_URI} !\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|map|json|xml|txt)$

# Redireciona todas as outras rotas para index.html
RewriteRule ^(.*)$ /index.html [L,QSA]
